from PyQt6.QtWidgets import *
from PyQt6 import uic
from PyQt6.QtWidgets import QMainWindow, QApplication, QTableWidgetItem
from PyQt6 import uic #if error remove this
from ui import main

from tabulate import tabulate
import array as arr
from ipaddress import ip_address
import nmap
import sys
import pyfiglet
import socket
import datetime
import os

class MainApp(QMainWindow):
    def __init__(self):
        super(MainApp, self).__init__()
        self.ui = main.Ui_MainWindow()
        self.ui.setupUi(self)
        # Connect signals and slots for UI elements here

    # Inside MainApp class
    def on_port_scanner_button_clicked(self):
        os.system("python port_scanner/sql.py")

        scanner = nmap.PortScanner()

        resp = 1

        while  resp !=0 :
            
            if resp == '1' : 
                os.system("python port_scanner/sql.py")

            

            elif resp == '2' :
                opt1=input("\nWebsite name : ")
                os.system("python domain_scanner/1.py "+opt1)
                
            elif resp == '3' :
                os.system("python wp/wpscanner.py ")

            elif resp == '4' :
                os.system("python sqlscanner/scan.py ")

            elif resp == '5' :
                opt1 = input("\nWebsite name : ")
                no = input("Number of parameters to be used: ")
                if int(no) == 0:
                    os.system("python Headerchecker/shcheck.py " + opt1) 
                    sys.exit()
                parameters = ["ff","-i", "-x", "-p", "-c"]  #add here
                mydata = [
                    ["-i", "1"],
                    ["-x", "2"],
                    ["-p", "3"],
                    ["-c", "4"]  
                ]
                head = ["Parameter", "Score"]
        

                # print(tabulate(mydata, headers=head, tablefmt="grid"))

                #i- 1 , x - 2, p - 3, c - 4
                
                lst = []
                
                count = 0
                while int(no) > count:
                    k = input("Enter Score: ")
                    if int(k) == 3:
                        prt_nu = input("Enter Port Number: ")
                    if int(k) == 4:
                        ck_value = input("Enter Cookie Value: ")
                    #add here for parameters with values


                    lst.append(k)
                    
                    count = count + 1
                
                
                if int(no) == 1:
                    opt2 = lst[0]
                    for x in lst:
                        if int(x) == 1:
                            opt2 = "-i"
                        elif int(x) == 2:
                            opt2= "-x"
                        elif int(x) == 3:
                            opt2= "-p" + prt_nu
                        elif int(x) == 4:
                            opt2= "-c" + ck_value

                        #add here

                    os.system("python Headerchecker/shcheck.py " + opt1 + " " + opt2) 
                elif int(no) == 2:
                    
                        #for opt 2
                    if int(lst[0]) == 1 :
                        opt2 = "-i"
                    elif int(lst[0]) == 2 :
                        opt2= "-x"
                    elif int(lst[0]) == 3 :
                        opt2= "-p" + prt_nu
                    elif int(lst[0]) == 4 :
                        opt2= "-c" + ck_value
                    
                        
                        #for opt 3
                    if int(lst[1]) == 1 :
                        opt3 = "-i"
                    elif int(lst[1]) == 2 :
                        opt3= "-x"
                    elif int(lst[1]) == 3 :
                        opt3= "-p" + prt_nu
                    elif int(lst[1]) == 4 :
                        opt3= "-c" + ck_value
                    #add here

                    os.system("python Headerchecker/shcheck.py " + opt1 + " " +opt2 + " " + opt3) 

                elif int(no) == 3:
                        #for opt 2
                    if int(lst[0]) == 1 :
                        opt2 = "-i"
                    elif int(lst[0]) == 2 :
                        opt2= "-x"
                    elif int(lst[0]) == 3 :
                        opt2= "-p" + prt_nu
                    elif int(lst[0]) == 4 :
                        opt2= "-c" + ck_value
                        
                        #for opt 3
                    if int(lst[1]) == 1 :
                        opt3 = "-i"
                    elif int(lst[1]) == 2 :
                        opt3= "-x"
                    elif int(lst[1]) == 3 :
                        opt3= "-p" + prt_nu
                    elif int(lst[1]) == 4 :
                        opt3= "-c" + ck_value
                    
                    #for opt 4
                    if int(lst[2]) == 1 :
                        opt4 = "-i"
                    elif int(lst[2]) == 2 :
                        opt4= "-x"
                    elif int(lst[2]) == 3 :
                        opt4= "-p" + prt_nu
                    elif int(lst[2]) == 4 :
                        opt4= "-c" + ck_value
                    
                    os.system("python Headerchecker/shcheck.py " + opt1 + " " + opt2 + " " + opt3 + " " + opt4) 

                    
                elif int(no) == 4:
                        #for opt 2
                    if int(lst[0]) == 1 :
                        opt2 = "-i"
                    elif int(lst[0]) == 2 :
                        opt2= "-x"
                    elif int(lst[0]) == 3 :
                        opt2= "-p" + prt_nu
                    elif int(lst[0]) == 4 :
                        opt2= "-c" + ck_value
                        
                        #for opt 3
                    if int(lst[1]) == 1 :
                        opt3 = "-i"
                    elif int(lst[1]) == 2 :
                        opt3= "-x"
                    elif int(lst[1]) == 3 :
                        opt3= "-p" + prt_nu
                    elif int(lst[1]) == 4 :
                        opt3= "-c" + ck_value
                    
                    #for opt 4
                    if int(lst[2]) == 1 :
                        opt4 = "-i"
                    elif int(lst[2]) == 2 :
                        opt4= "-x"
                    elif int(lst[2]) == 3 :
                        opt4= "-p" + prt_nu
                    elif int(lst[2]) == 4 :
                        opt4= "-c" + ck_value

                    #for opt 5
                    if int(lst[3]) == 1 :
                        opt5 = "-i"
                    elif int(lst[3]) == 2 :
                        opt5= "-x"
                    elif int(lst[3]) == 3 :
                        opt5= "-p" + prt_nu
                    elif int(lst[3]) == 4 :
                        opt5= "-c" + ck_value
                    
                    os.system("python Headerchecker/shcheck.py " + opt1 + " " + opt2 + " " + opt3 + " " + opt4 + " " + opt5) 
            
                

            elif resp == '6' :
                opt4="-u"
                opt5="--payload-level"
                opt6="7"
                opt7="--method"
                opt10="--cookie"
                opt3=input("\nWebsite name : ")
                usr=input(" 1.Normal scan\n 2.Enter custom payload\n 3.Method\n 4.Enter cookie value\n")
                
                if usr == '1':
                    os.system("python XSS_scanner/scan.py "+opt4+opt3)
                elif usr == '2':
                    os.system("python XSS_scanner/scan.py "+opt4+opt3+" "+opt5+" "+opt6)
                elif usr == '3':
                    opt9=input("0:GET\n 1:POST\n 2:GET and POST(Default)")
                    os.system("python XSS_scanner/scan.py "+opt4+opt3+" "+opt7+" "+opt9)
                elif (usr =='23' or usr =='32'):
                    opt9=input("0:GET\n 1:POST\n 2:GET and POST(Defaut)")
                    os.system("python XSS_scanner/scan.py "+opt4+opt3+" "+opt5+" "+opt6+" "+opt7+" "+opt9)
                elif usr == '4':
                    opt11=input("Enter cookie value(e.g {'ID':'1094200543'}):")
                    os.system("python XSS_scanner/scan.py "+opt4+opt3+" "+opt10+" "+opt11)
                
            elif resp == '7' :
                    website=input("Enter website name:")
                    os.system("python clickjacking/clickjacking.py "+" "+"-v"+" "+"-d"+website)

            else: 
                pass

            prgo = input("Do You Wish To do another scan('y' for yes and 'n' for No)?")   
            if prgo == 'y' :
                continue
            else : 
                break

if __name__ == "__main__":
    app = QApplication(sys.argv)
    window = MainApp()
    window.show()
    app.exec()


exit()